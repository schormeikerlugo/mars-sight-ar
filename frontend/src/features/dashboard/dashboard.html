<div class="dashboard-container">

  <!-- Header -->
  <header class="dash-header">
    <div class="dash-header-left">
      <div class="header-title-group">
        <div class="holo-logo-wrapper">
          <img src="/assets/logotipo.svg" alt="KEPLER" class="dash-logo holo-logo-img">
        </div>
        <div class="server-status">
          <span class="status-dot"></span>
          <span>Online</span>
          <span id="dash-gps-status" style="margin-left:10px; font-size:0.8em; opacity:0.7; font-weight:bold;"></span>
        </div>
      </div>

      <!-- Mobile hamburger button -->
      <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Abrir men√∫">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </div>

    <!-- Desktop navigation (hidden on mobile) -->
    <div class="dash-header-right desktop-nav">
      <button id="btn-start-mission" class="btn-start-mission">
        <img src="/icons/dashboard/Start-mission.svg" alt="Start" class="icon-btn" />
        <span>Start mission</span>
      </button>

      <button id="btn-archives" class="btn-nav-item">
        üì¶ ARCHIVOS
      </button>

      <button id="btn-taxonomia" class="btn-nav-item btn-taxonomia">
        üè∑Ô∏è TAXONOM√çA
      </button>

      <div class="header-divider"></div>

      <button class="btn-notifications" id="btn-notifications-header">
        <img src="/icons/dashboard/notifications.svg" alt="Notifications" class="icon-btn" />
        <span class="notification-badge" id="notification-badge" style="display:none">0</span>
      </button>

      <div class="user-profile-dropdown" id="user-profile-container" style="position:relative;">
        <button class="btn-user-profile" id="btn-user-profile">
          <span class="user-avatar" id="user-avatar">S</span>
          <span class="user-name" id="user-name">Schormaker</span>
          <span style="margin-left:5px; font-size:0.7rem;">‚ñº</span>
        </button>
        <div class="profile-dropdown-menu" id="profile-dropdown"
          style="display:none; position:absolute; top:100%; right:0; margin-top:8px; background:rgba(0,10,30,0.95); border:1px solid #3fa8ff; border-radius:10px; min-width:180px; z-index:1000; backdrop-filter:blur(10px);">
          <div style="padding:15px; border-bottom:1px solid rgba(63,168,255,0.2);">
            <div style="font-size:0.85rem; color:#888;">Conectado como</div>
            <div style="font-weight:bold; color:#3fa8ff;" id="dropdown-email">user@email.com</div>
          </div>
          <button id="btn-logout"
            style="width:100%; padding:12px 15px; background:transparent; border:none; color:#ff6b6b; font-family:'Jura',sans-serif; font-size:0.95rem; cursor:pointer; text-align:left; transition:background 0.2s;">
            üö™ Cerrar Sesi√≥n
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile navigation overlay -->
  <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>

  <!-- Mobile slide-out menu -->
  <nav class="mobile-nav" id="mobile-nav">
    <div class="mobile-nav-header">
      <span class="mobile-nav-title">MEN√ö</span>
      <button class="mobile-nav-close" id="mobile-nav-close">‚úï</button>
    </div>

    <div class="mobile-nav-user">
      <span class="mobile-user-avatar" id="mobile-user-avatar">S</span>
      <div class="mobile-user-info">
        <span class="mobile-user-name" id="mobile-user-name">Schormaker</span>
        <span class="mobile-user-email" id="mobile-user-email">user@email.com</span>
      </div>
    </div>

    <div class="mobile-nav-items">
      <button class="mobile-nav-item" id="mobile-btn-start-mission">
        üöÄ <span>Iniciar Misi√≥n</span>
      </button>
      <button class="mobile-nav-item" id="mobile-btn-archives">
        üì¶ <span>Archivos</span>
      </button>
      <button class="mobile-nav-item" id="mobile-btn-taxonomia">
        üè∑Ô∏è <span>Taxonom√≠a</span>
      </button>
      <button class="mobile-nav-item" id="mobile-btn-notifications">
        üîî <span>Notificaciones</span>
        <span class="mobile-badge">3</span>
      </button>
    </div>

    <div class="mobile-nav-footer">
      <button class="mobile-nav-logout" id="mobile-btn-logout">
        üö™ Cerrar Sesi√≥n
      </button>
    </div>
  </nav>

  <!-- Main Content Grid -->
  <div class="dash-main">

    <!-- Left: Telemetry Panel -->
    <aside class="dash-telemetry scanline-effect">
      <h3 class="telem-title">Telemetr√≠a</h3>

      <div class="telem-metric">
        <span class="telem-value" id="telem-temp">20¬∞C</span>
        <span class="telem-label">TEMPERATURA</span>
      </div>

      <div class="telem-metric">
        <span class="telem-value" id="telem-o2">96%</span>
        <span class="telem-label">O2</span>
      </div>

      <div class="telem-metric">
        <span class="telem-value" id="telem-bpm">75</span>
        <span class="telem-label">BPM</span>
      </div>

      <div class="telem-metric">
        <span class="telem-value" id="telem-rad">0.011</span>
        <span class="telem-label">RAD</span>
      </div>
    </aside>

    <!-- Center: AI Chat with Llama 3 -->
    <section class="dash-ai-chat">
      <div class="chat-header">
        <img src="/icons/dashboard/IA.svg" alt="IA" class="chat-icon-img" />
        <span class="chat-title">Llama 3.8</span>

        <div class="chat-actions">
          <button id="btn-chat-history" class="icon-action-btn" title="Historial">
            <img src="/icons/history.svg" alt="History" />
          </button>
          <button id="btn-new-chat" class="icon-action-btn" title="Nuevo Chat">
            <img src="/icons/new-chat.svg" alt="New Chat" />
          </button>
        </div>
      </div>

      <div class="chat-messages" id="chat-messages">
        <div class="chat-message ai-message">
          ¬øC√≥mo puedo ayudarte hoy?
        </div>
      </div>

      <div class="chat-suggestions" id="chat-suggestions">
        <button class="suggestion-btn" data-prompt="Examinar los objetos que se han registrado en este √∫ltimo viaje">
          Examinar los objetos que se han registrado en este √∫ltimo viaje
        </button>
        <button class="suggestion-btn" data-prompt="Revisar los √∫ltimos POIs y med√≠ la distancia que se ha recorrido">
          Revisar los √∫ltimos POIs y med√≠ la distancia que se ha recorrido
        </button>
        <button class="suggestion-btn" data-prompt="Examinar los objetos que no tienen descripci√≥n y darles una">
          Examinar los objetos que no tienen descripci√≥n y darles una
        </button>
      </div>

      <div class="chat-input-container">
        <input type="text" id="chat-input" class="chat-input" placeholder="Preg√∫ntale algo a la IA..."
          autocomplete="off" />
        <button id="btn-send-chat" class="btn-send-chat">
          <span>‚Üí</span>
        </button>
      </div>
    </section>

    <!-- Right: Data Grid -->
    <aside class="dash-data-grid">

      <!-- POIs Card -->
      <div class="data-card">
        <div class="data-card-header">
          <img src="/icons/dashboard/POIs.svg" alt="POIs" class="card-icon-img" />
          <span class="card-title">POIs</span>
          <span class="data-count" id="pois-count">20</span>
        </div>
        <div class="data-list" id="pois-list">
          <!-- Dynamically populated -->
        </div>
      </div>

      <!-- Minerals Card -->
      <div class="data-card">
        <div class="data-card-header">
          <img src="/icons/dashboard/Minerals.svg" alt="Minerals" class="card-icon-img" />
          <span class="card-title">Minerals</span>
          <span class="data-count" id="minerals-count">85</span>
        </div>
        <div class="data-list" id="minerals-list">
          <!-- Dynamically populated -->
        </div>
      </div>

      <!-- Missions Card -->
      <div class="data-card">
        <div class="data-card-header">
          <img src="/icons/dashboard/Missions.png" alt="Missions" class="card-icon-img" />
          <span class="card-title">Missions</span>
          <span class="data-count" id="missions-count">24</span>
        </div>
        <div class="data-list" id="missions-list">
          <!-- Dynamically populated -->
        </div>
      </div>

      <!-- Objects Card -->
      <div class="data-card">
        <div class="data-card-header">
          <img src="/icons/dashboard/Objects.svg" alt="Objects" class="card-icon-img" />
          <span class="card-title">Objects</span>
          <span class="data-count" id="objects-count">85</span>
        </div>
        <div class="data-list" id="objects-list">
          <!-- Dynamically populated -->
        </div>
      </div>

    </aside>

  </div>

</div>

<!-- Mission Modal -->
<div class="history-modal" id="mission-modal" style="display:none; align-items:center; justify-content:center;">
  <div class="history-content" style="height:auto; min-height:300px; max-width:500px;">
    <div class="history-header">
      <h3>INICIAR NUEVA MISI√ìN</h3>
      <button id="btn-close-mission" class="btn-close-history">√ó</button>
    </div>
    <div style="padding:25px; color:white; display:flex; flex-direction:column; gap:15px;">
      <div>
        <label style="display:block; margin-bottom:8px; color:#00aaff; font-weight:bold;">NOMBRE DE MISI√ìN</label>
        <input type="text" id="inp-dash-mission-title" placeholder="Ej: Exploraci√≥n Sector 7"
          style="width:100%; padding:12px 15px; background:rgba(0,0,0,0.3); border:1px solid #0055aa; color:white; border-radius:8px; box-sizing:border-box; font-family:'Jura',sans-serif;">
      </div>

      <div>
        <label style="display:block; margin-bottom:8px; color:#00aaff; font-weight:bold;">ZONA / OBJETIVO</label>
        <input type="text" id="inp-dash-mission-zone" placeholder="Ej: Cr√°ter Jezero Norte"
          style="width:100%; padding:12px 15px; background:rgba(0,0,0,0.3); border:1px solid #0055aa; color:white; border-radius:8px; box-sizing:border-box; font-family:'Jura',sans-serif;">
      </div>

      <div style="margin-top:10px; display:flex; gap:10px;">
        <button id="btn-confirm-start-mission"
          style="flex:1; padding:14px; background:#00aaff; border:none; color:white; font-weight:bold; cursor:pointer; border-radius:10px; font-family:'Jura',sans-serif;">
          DESPEGAR üöÄ
        </button>
      </div>
    </div>
  </div>
</div>

<!-- History Modal -->
<div class="history-modal" id="history-modal">
  <div class="history-content">
    <div class="history-header">
      <h3>Historial de Conversaciones</h3>
      <button id="btn-close-history" class="btn-close-history">√ó</button>
    </div>
    <div class="history-list" id="history-list">
      <!-- Dyn items -->
    </div>
  </div>
</div>

<!-- Chat FAB (Mobile Only) -->
<button class="chat-fab" id="chat-fab" aria-label="Abrir chat">
  <svg class="chat-fab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
  </svg>
</button>

<!-- Chat Modal (Mobile Fullscreen - OpenWebUI Style) -->
<div class="chat-modal-overlay" id="chat-modal-overlay">

  <!-- Header with menu and close button -->
  <div class="chat-modal-header">
    <div class="chat-modal-header-left">
      <img src="/icons/dashboard/IA.svg" alt="AI" class="chat-icon-img" />
      <span class="chat-title">LLAMA 3.1</span>
    </div>
    <div class="chat-modal-header-right">
      <!-- Menu button -->
      <button class="chat-modal-menu-btn" id="chat-modal-menu-btn">‚ò∞</button>
    </div>

    <!-- Dropdown menu -->
    <div class="chat-modal-menu" id="chat-modal-menu">
      <button class="chat-menu-item" id="modal-new-chat">
        <span>‚ú®</span> Nuevo Chat
      </button>
      <button class="chat-menu-item" id="modal-history">
        <span>üìú</span> Historial
      </button>
      <button class="chat-menu-item danger" id="modal-exit">
        <span>üö™</span> Volver al Dashboard
      </button>
    </div>
  </div>

  <!-- Body -->
  <div class="chat-modal-body">

    <!-- Welcome section (shown initially) -->
    <div class="chat-modal-welcome" id="chat-modal-welcome">
      <img src="/icons/dashboard/IA.svg" alt="AI" class="chat-modal-icon" />
      <div class="chat-modal-model-name">LLAMA 3.1</div>

      <!-- Input box -->
      <div class="chat-modal-input-wrapper">
        <div class="chat-modal-input-box">
          <input type="text" class="chat-modal-input" id="chat-modal-input" placeholder="¬øC√≥mo puedo ayudarte hoy?" />
          <div class="chat-modal-input-actions">
            <button class="btn-send-modal" id="btn-send-modal">‚û§</button>
          </div>
        </div>
      </div>

      <!-- Suggestions -->
      <div class="chat-modal-suggestions" id="chat-modal-suggestions">
        <div class="suggestions-label">
          <span>‚ú®</span> Sugerido
        </div>
        <div class="suggestion-card" data-prompt="¬øQu√© minerales puedo analizar en Marte?">
          <div class="suggestion-title">üî¨ An√°lisis de minerales</div>
          <div class="suggestion-desc">Tipos y m√©todos de detecci√≥n</div>
        </div>
        <div class="suggestion-card" data-prompt="¬øC√≥mo inicio una nueva misi√≥n de exploraci√≥n?">
          <div class="suggestion-title">üöÄ Nueva misi√≥n</div>
          <div class="suggestion-desc">Gu√≠a paso a paso</div>
        </div>
        <div class="suggestion-card" data-prompt="¬øQu√© significa cada indicador de telemetr√≠a?">
          <div class="suggestion-title">üìä Telemetr√≠a</div>
          <div class="suggestion-desc">Explicaci√≥n de indicadores</div>
        </div>
      </div>
    </div>

    <!-- Messages (shown when chatting) -->
    <div class="chat-modal-messages" id="chat-modal-messages">
      <!-- Messages will appear here -->
    </div>

  </div>

  <!-- Bottom input (shown when chatting) -->
  <div class="chat-modal-input-bottom" id="chat-modal-input-bottom">
    <input type="text" class="chat-input" id="chat-modal-input-active" placeholder="Escribe tu mensaje...">
    <button class="btn-send-chat" id="btn-send-modal-active">‚û§</button>
  </div>

</div>

</div>